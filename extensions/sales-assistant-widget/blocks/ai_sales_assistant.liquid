{% schema %}
{
  "name": "AI Sales Assistant",
  "target": "body",
  "settings": [
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Enable AI Assistant",
      "default": true
    },
    {
      "type": "select",
      "id": "position",
      "label": "Position",
      "options": [
        { "value": "bottom-right", "label": "Bottom Right" },
        { "value": "bottom-left", "label": "Bottom Left" },
        { "value": "top-right", "label": "Top Right" },
        { "value": "top-left", "label": "Top Left" },
        { "value": "center-right", "label": "Center Right" },
        { "value": "center-left", "label": "Center Left" }
      ],
      "default": "bottom-right"
    },
    {
      "type": "header",
      "content": "General Settings"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Ask AI Assistant"
    },
    {
      "type": "text",
      "id": "chat_title",
      "label": "Chat Title",
      "default": "AI Sales Assistant"
    },
    {
      "type": "text",
      "id": "status_text",
      "label": "Status Text",
      "default": "Online"
    },
    {
      "type": "text",
      "id": "close_button_label",
      "label": "Close Button Label",
      "default": "Close"
    },
    {
      "type": "textarea",
      "id": "welcome_message",
      "label": "Welcome Message",
      "default": "Hello! I'm your AI sales assistant. I can help you find products, answer questions, and provide personalized recommendations."
    },
    {
      "type": "text",
      "id": "input_placeholder",
      "label": "Input Placeholder",
      "default": "Ask me anything about our products..."
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "Primary Color",
      "default": "#ee5cee"
    },
    {
      "type": "header",
      "content": "Welcome Screen - Quick Actions"
    },
    {
      "type": "text",
      "id": "section_discovery_label",
      "label": "Product Discovery Section Label",
      "default": "Product Discovery"
    },
    {
      "type": "text",
      "id": "best_sellers_text",
      "label": "Best Sellers Button",
      "default": "Best Sellers"
    },
    {
      "type": "text",
      "id": "new_arrivals_text",
      "label": "New Arrivals Button",
      "default": "New Arrivals"
    },
    {
      "type": "text",
      "id": "on_sale_text",
      "label": "On Sale Button",
      "default": "On Sale"
    },
    {
      "type": "text",
      "id": "recommendations_text",
      "label": "Recommendations Button",
      "default": "For You"
    },
    {
      "type": "header",
      "content": "Welcome Screen - Support Actions"
    },
    {
      "type": "text",
      "id": "section_support_label",
      "label": "Support Section Label",
      "default": "Customer Support"
    },
    {
      "type": "text",
      "id": "shipping_text",
      "label": "Shipping Button",
      "default": "Shipping Info"
    },
    {
      "type": "text",
      "id": "returns_text",
      "label": "Returns Button",
      "default": "Returns"
    },
    {
      "type": "text",
      "id": "track_order_text",
      "label": "Track Order Button",
      "default": "Track Order"
    },
    {
      "type": "text",
      "id": "help_text",
      "label": "Help Button",
      "default": "Help & FAQ"
    }
  ]
}
{% endschema %}

<!-- 1. Render container -->
<div id="ai-sales-assistant-container"></div>

<!-- 2. Expose settings with fallback defaults -->
<script>
  window.aiSalesAssistantSettings = {
    // Use block settings if available, otherwise use defaults
    enabled: {{ settings.enabled | default: true | json }},
    position: {{ settings.position | default: "bottom-right" | json }},
    buttonText: {{ settings.button_text | default: "Ask AI Assistant" | json }},
    chatTitle: {{ settings.chat_title | default: "AI Sales Assistant" | json }},
    statusText: {{ settings.status_text | default: "Online" | json }},
    closeButtonLabel: {{ settings.close_button_label | default: "Close" | json }},
    welcomeMessage: {{ settings.welcome_message | default: "Hello! I'm your AI sales assistant. How can I help you today?" | json }},
    inputPlaceholder: {{ settings.input_placeholder | default: "Ask me anything about our products..." | json }},
    primaryColor: {{ settings.primary_color | default: "#ee5cee" | json }},
    sectionDiscoveryLabel: {{ settings.section_discovery_label | default: "Product Discovery" | json }},
    bestSellersText: {{ settings.best_sellers_text | default: "Best Sellers" | json }},
    newArrivalsText: {{ settings.new_arrivals_text | default: "New Arrivals" | json }},
    onSaleText: {{ settings.on_sale_text | default: "On Sale" | json }},
    recommendationsText: {{ settings.recommendations_text | default: "For You" | json }},
    sectionSupportLabel: {{ settings.section_support_label | default: "Customer Support" | json }},
    shippingText: {{ settings.shipping_text | default: "Shipping Info" | json }},
    returnsText: {{ settings.returns_text | default: "Returns" | json }},
    trackOrderText: {{ settings.track_order_text | default: "Track Order" | json }},
    helpText: {{ settings.help_text | default: "Help & FAQ" | json }},
    shopDomain: {{ shop.permanent_domain | json }},
    currency: {{ shop.currency | json }}
  };
</script>

<!-- 3. LOAD JS & CSS FROM THEME APP EXTENSION ASSETS -->
<script src="{{ 'ai-sales-assistant.js' | asset_url }}" defer></script>
<link rel="stylesheet" href="{{ 'ai-sales-assistant.css' | asset_url }}">